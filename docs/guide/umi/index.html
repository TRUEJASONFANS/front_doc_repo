<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Umi | 前端知识图谱</title>
    <meta name="description" content="front knowledge collecting repo.">
    
    
    <link rel="preload" href="/front_doc_repo/assets/css/0.styles.268104d5.css" as="style"><link rel="preload" href="/front_doc_repo/assets/js/app.ed1c3288.js" as="script"><link rel="preload" href="/front_doc_repo/assets/js/2.37bbb80c.js" as="script"><link rel="preload" href="/front_doc_repo/assets/js/28.3417d45f.js" as="script"><link rel="prefetch" href="/front_doc_repo/assets/js/10.fe564fdb.js"><link rel="prefetch" href="/front_doc_repo/assets/js/11.b442cb13.js"><link rel="prefetch" href="/front_doc_repo/assets/js/12.d66a543f.js"><link rel="prefetch" href="/front_doc_repo/assets/js/13.a02db5fc.js"><link rel="prefetch" href="/front_doc_repo/assets/js/14.faf831c2.js"><link rel="prefetch" href="/front_doc_repo/assets/js/15.fae60d2b.js"><link rel="prefetch" href="/front_doc_repo/assets/js/16.cf2a7f5c.js"><link rel="prefetch" href="/front_doc_repo/assets/js/17.223a70a7.js"><link rel="prefetch" href="/front_doc_repo/assets/js/18.c60a5a67.js"><link rel="prefetch" href="/front_doc_repo/assets/js/19.a9a6e649.js"><link rel="prefetch" href="/front_doc_repo/assets/js/20.3825f27c.js"><link rel="prefetch" href="/front_doc_repo/assets/js/21.7e87ed99.js"><link rel="prefetch" href="/front_doc_repo/assets/js/22.cdf36508.js"><link rel="prefetch" href="/front_doc_repo/assets/js/23.d2d8060f.js"><link rel="prefetch" href="/front_doc_repo/assets/js/24.3d32fae5.js"><link rel="prefetch" href="/front_doc_repo/assets/js/25.bf884bc0.js"><link rel="prefetch" href="/front_doc_repo/assets/js/26.c550dd3f.js"><link rel="prefetch" href="/front_doc_repo/assets/js/27.361e5fff.js"><link rel="prefetch" href="/front_doc_repo/assets/js/29.f51e2415.js"><link rel="prefetch" href="/front_doc_repo/assets/js/3.bcfa361d.js"><link rel="prefetch" href="/front_doc_repo/assets/js/30.3eb2779c.js"><link rel="prefetch" href="/front_doc_repo/assets/js/31.28323663.js"><link rel="prefetch" href="/front_doc_repo/assets/js/32.7d563f0d.js"><link rel="prefetch" href="/front_doc_repo/assets/js/33.3b3c6b2d.js"><link rel="prefetch" href="/front_doc_repo/assets/js/34.5e0d5afc.js"><link rel="prefetch" href="/front_doc_repo/assets/js/35.b9c849f9.js"><link rel="prefetch" href="/front_doc_repo/assets/js/36.09c3ca34.js"><link rel="prefetch" href="/front_doc_repo/assets/js/37.8bb49e1b.js"><link rel="prefetch" href="/front_doc_repo/assets/js/38.0a3f2eae.js"><link rel="prefetch" href="/front_doc_repo/assets/js/39.fb5a12ec.js"><link rel="prefetch" href="/front_doc_repo/assets/js/4.345e7341.js"><link rel="prefetch" href="/front_doc_repo/assets/js/5.17c730f4.js"><link rel="prefetch" href="/front_doc_repo/assets/js/6.40d9b15a.js"><link rel="prefetch" href="/front_doc_repo/assets/js/7.6bbb8551.js"><link rel="prefetch" href="/front_doc_repo/assets/js/8.cfdc6372.js"><link rel="prefetch" href="/front_doc_repo/assets/js/9.90875d31.js">
    <link rel="stylesheet" href="/front_doc_repo/assets/css/0.styles.268104d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/front_doc_repo/" class="home-link router-link-active"><!----> <span class="site-name">前端知识图谱</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/front_doc_repo/guide/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><a href="/front_doc_repo/api/" class="nav-link">API</a></div><div class="nav-item"><a href="/front_doc_repo/knowledgemap/" class="nav-link">知识图谱</a></div> <a href="https://github.com/TRUEJASONFANS/front_doc_repo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/front_doc_repo/guide/" class="nav-link router-link-active">指南</a></div><div class="nav-item"><a href="/front_doc_repo/api/" class="nav-link">API</a></div><div class="nav-item"><a href="/front_doc_repo/knowledgemap/" class="nav-link">知识图谱</a></div> <a href="https://github.com/TRUEJASONFANS/front_doc_repo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front_doc_repo/guide/" class="sidebar-link">工具链</a></li><li><a href="/front_doc_repo/guide/packageManager.html" class="sidebar-link">包管理器</a></li><li><a href="/front_doc_repo/guide/packager/" class="sidebar-link">打包器</a></li><li><a href="/front_doc_repo/guide/compiler.html" class="sidebar-link">编译器Babel</a></li><li><a href="/front_doc_repo/guide/packager/others.html" class="sidebar-link">其他打包器相关</a></li><li><a href="/front_doc_repo/guide/unit_test.html" class="sidebar-link">测试</a></li><li><a href="/front_doc_repo/guide/canvas_doc/" class="sidebar-link">Canvas</a></li><li><a href="/front_doc_repo/guide/css_doc/" class="sidebar-link">CSS世界</a></li><li><a href="/front_doc_repo/guide/umi/" class="active sidebar-link">Umi</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#历史" class="sidebar-link">历史</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#两个框架融合之和" class="sidebar-link">两个框架融合之和</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#理论基础" class="sidebar-link">理论基础</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#架构" class="sidebar-link">架构</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#设计理念" class="sidebar-link">设计理念</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#资产市场-一个人能干-10-个人的活" class="sidebar-link">资产市场 (一个人能干 10 个人的活)</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#如何兼顾多类技术栈" class="sidebar-link">如何兼顾多类技术栈</a></li><li class="sidebar-sub-header"><a href="/front_doc_repo/guide/umi/#参考" class="sidebar-link">参考</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="umi"><a href="#umi" aria-hidden="true" class="header-anchor">#</a> Umi</h1> <h2 id="历史"><a href="#历史" aria-hidden="true" class="header-anchor">#</a> 历史</h2> <h3 id="react-roof-redux-dva-umi-bigfish-umi"><a href="#react-roof-redux-dva-umi-bigfish-umi" aria-hidden="true" class="header-anchor">#</a> React -&gt; Roof -&gt; Redux -&gt; Dva -&gt; Umi+bigfish -&gt; Umi</h3> <p>“2015 年之前我们有 Sea.JS、Arale、SPM 开源技术方案，大家可以有所耳闻。
2015 年我们接入 React，从自研的 Roof 到 Redux 再到开源的 Dva，一步步验证我们的最佳实践，并把这些实践交给开源社区检验。
2017 年开始尝试了新一代的企业级前端框架，Umi 和 Bigfish，前者是从无线业务中长出来的，后者是从中台业务中长出来的。
一个团队出两个框架毕竟不是长久之计，后来老大直接把两拨人调到一个组，于是就愉快地合并在了一起。”
<img src="http://5b0988e595225.cdn.sohucs.com/images/20190717/8e42b0fbccba4ff48a4f7f9f2acbdcc5.jpeg" alt="历史"></p> <h2 id="两个框架融合之和"><a href="#两个框架融合之和" aria-hidden="true" class="header-anchor">#</a> 两个框架融合之和</h2> <p><img src="http://5b0988e595225.cdn.sohucs.com/images/20190717/7c6ab855060444f281cdc424d2221fba.jpeg" alt="两个框架融合之和"></p> <p>内部数据：</p> <p><img src="http://5b0988e595225.cdn.sohucs.com/images/20190717/8f84ae3045ba4e7c9dd218a876e1c790.jpeg" alt="内部数据"></p> <h2 id="理论基础"><a href="#理论基础" aria-hidden="true" class="header-anchor">#</a> 理论基础</h2> <p><img src="https://shipusercontent.com/5af08fa4045b39c3110110510422527b/Pasted%20Image%202.png" alt="Utilize compiler"> <a href="https://tomdale.net/2017/09/compilers-are-the-new-frameworks/" target="_blank" rel="noopener noreferrer">umi as a CompilerFull Version<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>大意</strong>: 本期文章篇幅短小却言简意骇，文中开头作者就抛出自己的观点 <strong>Web 框架正在从运行库转变为优化编译器</strong>。
[精读]]](https://zhuanlan.zhihu.com/p/34931049)</p> <p>Umi 更像一个<strong>编译期框架</strong></p> <h2 id="架构"><a href="#架构" aria-hidden="true" class="header-anchor">#</a> 架构</h2> <p><img src="https://gw.alipayobjects.com/zos/rmsportal/zvfEXesXdgTzWYZCuHLe.png" alt="架构"></p> <p>“那么别人为啥要用你的框架？首先，框架要好用，这是最基本的；然后，使用者尤其是资深的前端同学，还得在这上面找到自己的成就感和 ownership，另外如果绩效漂亮就更好了。总不能别人用你的框架，然后只有你自己一个人的绩效好，那是不会长久的。”</p> <p>解法:基于插件体系
<img src="https://static001.infoq.cn/resource/image/49/db/49309c4100276f9968520b3d1d2424db.png" alt="Bigfish架构"></p> <ul><li>可以写一个独立的功能插件，比如和某个服务的对接，比如扩展路由的某个功能，比如实现一套特殊的补丁方案；</li> <li>可以做归类，把一系列插件整理到一个插件集里，适用于某一类的业务开发；</li> <li>可以扩展应用类型，比如 SPA、MPA、微前端等等；</li> <li>可以扩展部署模式，比如和不同的框架或平台做结合；</li></ul> <p><img src="https://static001.infoq.cn/resource/image/ed/38/ed9798f035cfddf3ac759740404ad138.png" alt="插件生命周期"></p> <h2 id="设计理念"><a href="#设计理念" aria-hidden="true" class="header-anchor">#</a> 设计理念</h2> <p>React 的核心概念就是组件。
UMI框架的主要功能，就是定义了一套<strong>编写和使用组件的规范</strong>。</p> <h3 id="代码分层"><a href="#代码分层" aria-hidden="true" class="header-anchor">#</a> 代码分层</h3> <p><img src="https://gw.alipayobjects.com/zos/rmsportal/trbRYJugHYeODogmIgwi.png" alt="UMI前端代码层次">
上图中，左侧是服务端代码的层次结构，由 Controller、Service、Data Access 三层组成服务端系统：</p> <ol><li>Controller 层负责与用户直接打交道，渲染页面、提供接口等，侧重于展示型逻辑。</li> <li>Service 层负责处理业务逻辑，供 Controller 层调用。</li> <li>Data Access 层顾名思义，负责与数据源对接，进行纯粹的数据读写，供 Service 层调用。</li></ol> <p>上图的右侧是前端代码的结构，同样需要进行必要的分层：</p> <ol><li>Page 负责与用户直接打交道：渲染页面、接受用户的操作输入，侧重于展示型交互性逻辑。</li> <li>Model 负责处理业务逻辑，为 Page 做数据、状态的读写、变换、暂存等。</li> <li>Service 负责与 HTTP 接口对接，进行纯粹的数据读写。</li></ol> <h3 id="react-react-redux-redux-saga-dva"><a href="#react-react-redux-redux-saga-dva" aria-hidden="true" class="header-anchor">#</a> React -&gt; React Redux -&gt; Redux saga-&gt; Dva</h3> <p><a href="https://www.yuque.com/flying.ni/the-tower/tvzasn" target="_blank" rel="noopener noreferrer">图解React-&gt;React Redux-&gt; Redux sage-&gt; Dva<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="model"><a href="#model" aria-hidden="true" class="header-anchor">#</a> Model</h3> <p>Model 是前端分层中的腰部力量，承上启下，负责管理数据（状态）。业界主流的状态管理类库有 redux、mobx，等。在我们的教程中，则使用 <a href="https://dvajs.com/guide/concepts.html#%E6%95%B0%E6%8D%AE%E6%B5%81%E5%90%91" target="_blank" rel="noopener noreferrer">Dva概念<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 框架承担这一角色。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> pathToRegexp <span class="token keyword">from</span> <span class="token string">'path-to-regexp'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> pockerService <span class="token keyword">from</span> <span class="token string">'@/pages/pockerRoom/services/pockerService'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> number<span class="token punctuation">,</span> string <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'prop-types'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespace<span class="token punctuation">:</span> <span class="token string">'pockerBoard'</span><span class="token punctuation">,</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    scoreList<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    roomName<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    resetFlag<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    curPage<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    totalPage<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    clickedNum<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>
    playerName<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    featureName<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    internalTaskName<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  reducers<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">//同步操作</span>

    <span class="token function">syncRoomName</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span> payload<span class="token punctuation">:</span> <span class="token punctuation">{</span> roomName <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> roomName <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    
    <span class="token function">syncPage</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> <span class="token punctuation">{</span>payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>curPage<span class="token punctuation">,</span> totalPage<span class="token punctuation">,</span> resetFlag<span class="token punctuation">,</span> scoreList<span class="token punctuation">,</span> playerName<span class="token punctuation">,</span> clickedNum<span class="token punctuation">,</span> featureName<span class="token punctuation">,</span> internalTaskName<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span> curPage<span class="token punctuation">,</span> totalPage<span class="token punctuation">,</span> resetFlag <span class="token punctuation">,</span> scoreList<span class="token punctuation">,</span> playerName<span class="token punctuation">,</span> clickedNum<span class="token punctuation">,</span> featureName<span class="token punctuation">,</span> internalTaskName<span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// syncTotalPage(state, {payload: {totalPage}}) {</span>
    <span class="token comment">//   return {...state, totalPage}</span>
    <span class="token comment">// }</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  effects<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">//异步操作</span>
    <span class="token operator">*</span><span class="token function">queryStoryPoints</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> roomName <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>pockerService<span class="token punctuation">,</span> roomName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token function">onClickPocker</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> values <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>pockerService<span class="token punctuation">.</span>onClickPocker<span class="token punctuation">,</span> values<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token function">addTicketRecord</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> values <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>pockerService<span class="token punctuation">.</span><span class="token function">addTikcetRecord</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token function">onNextGame</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> values <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>pockerService<span class="token punctuation">.</span><span class="token function">onNextGame</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token function">AddStory</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> values <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>pockerService<span class="token punctuation">.</span><span class="token function">addStory</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">*</span><span class="token function">onNavigateToPage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> values <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> call <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>pockerService<span class="token punctuation">.</span><span class="token function">onNavigateToPage</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  subscriptions<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token comment">//订阅操作</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> history <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> history<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token parameter">location</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> match <span class="token operator">=</span> <span class="token function">pathToRegexp</span><span class="token punctuation">(</span><span class="token string">'/pockerRoom/:id'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">if</span> <span class="token punctuation">(</span>match<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> roomId <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token comment">//TODO: verify the backend whether the room is created or not</span>
          <span class="token comment">// join room</span>
          <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            type<span class="token punctuation">:</span> <span class="token string">'syncRoomName'</span><span class="token punctuation">,</span>
            payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              roomName<span class="token punctuation">:</span> roomId<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          pockerService<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> parseJson <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              type<span class="token punctuation">:</span> <span class="token string">'syncPage'</span><span class="token punctuation">,</span>
              payload<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                curPage<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>curNum<span class="token punctuation">,</span>
                totalPage<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>totalNum<span class="token punctuation">,</span>
                resetFlag<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>reset<span class="token punctuation">,</span>
                clickedNum<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>clickedNum<span class="token punctuation">,</span>
                scoreList<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>playerScoreList<span class="token punctuation">,</span>
                playerName<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>playerName<span class="token punctuation">,</span>
                featureName<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>featureName<span class="token punctuation">,</span>
                internalTaskName<span class="token punctuation">:</span> parseJson<span class="token punctuation">.</span>internalTaskName
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> roomId<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="约定式路由-or-配置式路由"><a href="#约定式路由-or-配置式路由" aria-hidden="true" class="header-anchor">#</a> 约定式路由 or 配置式路由</h3> <p><a href="https://umijs.org/zh/guide/router.html" target="_blank" rel="noopener noreferrer">路由<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="其他"><a href="#其他" aria-hidden="true" class="header-anchor">#</a> 其他</h3> <p>umi 是基于路由的，所以具备了管理入口的能力。你甚至可以简单地理解为 umi = 路由 + webpack，在此基础上做了很多额外的工作。然后，管理了入口之后，能做的事情就很多了。
比如：</p> <ul><li>开发时按需编译</li> <li>运行时按需加载，做 code-splitting</li> <li>智能提取公共代码，加速用户访问，通常是被 路由数/2 引用的模块才被提取到公共代码中</li> <li>服务端渲染</li> <li>基于路由的埋点</li> <li>基于约定，如果 ./src/pages/404.js 存在则添加为 fallback 路由</li> <li>...</li></ul> <h2 id="资产市场-一个人能干-10-个人的活"><a href="#资产市场-一个人能干-10-个人的活" aria-hidden="true" class="header-anchor">#</a> 资产市场 (一个人能干 10 个人的活)</h2> <p>资产市场分了四级:</p> <ol><li>组件，指通用组件，就是 antd，在下半年将要发布的 antd@4 里，我们会陆续提取更多通用组件到 antd 中。</li> <li>业务组件，不能提取通用组件的，我们会提到内部统一的业务组件仓库中。</li> <li>区块，由组件组成，可以想象成代码片段。 你可以自己定义自己的<a href="https://umijs.org/zh/guide/block.html#%E4%BD%BF%E7%94%A8%E5%8C%BA%E5%9D%97" target="_blank" rel="noopener noreferrer">区块<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>以达到快速的代码初始化。[</li> <li>页面模板，由区块组成</li></ol> <p>市场：
<img src="http://5b0988e595225.cdn.sohucs.com/images/20190717/3fe672829b914e7994c8078f6e923654.jpeg" alt="UMI"> <img src="http://5b0988e595225.cdn.sohucs.com/images/20190717/1e007f12a4ff42cea0b50ffe5f5020f8.jpeg" alt="bigsh&amp;&amp;UMI市场"></p> <h2 id="如何兼顾多类技术栈"><a href="#如何兼顾多类技术栈" aria-hidden="true" class="header-anchor">#</a> 如何兼顾多类技术栈</h2> <ul><li>MPA（多页应用）部署较为麻烦？</li> <li>微前端 -&gt; <a href="https://github.com/umijs/qiankun" target="_blank" rel="noopener noreferrer">&quot;乾坤&quot;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 基于SPA 部署更简单？</li></ul> <h2 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://antd-course.ulivz.com/tydf0a.html" target="_blank" rel="noopener noreferrer">Ant design实战<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/sorrycc/blog/issues/85" target="_blank" rel="noopener noreferrer">蚂蚁金服的前端框架和工程化实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/TRUEJASONFANS/front_doc_repo/edit/master/src/guide/umi/readme.md" target="_blank" rel="noopener noreferrer">在 github 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">11/7/2019, 5:57:57 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/front_doc_repo/guide/css_doc/" class="prev">
          CSS世界
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/front_doc_repo/assets/js/app.ed1c3288.js" defer></script><script src="/front_doc_repo/assets/js/2.37bbb80c.js" defer></script><script src="/front_doc_repo/assets/js/28.3417d45f.js" defer></script>
  </body>
</html>
